---
layout: post
title: 立即执行函数
categories: [js]
description: 立即执行函数的简单介绍
keywords: redis, NoSQL

---

# 函数表达式

**函数声明**：function fnName () {…};使用function关键字声明一个函数，再指定一个函数名，叫函数声明。

**函数表达式**：函数表达式 var fnName = function () {…};使用function关键字声明一个函数，但未给函数命名，最后将匿名函数赋予一个变量，叫函数表达式，这是最常见的函数表达式语法形式。

**匿名函数**：function () {}; 使用function关键字声明一个函数，但未给函数命名，所以叫匿名函数，匿名函数属于函数表达式，匿名函数有很多作用，赋予一个变量则创建函数，赋予一个事件则成为事件处理程序或创建闭包等等。

**ps**：只有函数表达式才能立即调用，*（）、！、+、-、=*等运算符，都将函数声明转换成函数表达式

```js
(function(a){
    console.log(a);   //firebug输出1234，使用（）运算符
}(1234));

!function(a){
    console.log(a);   //firebug输出12345,使用！运算符
}(12345);

+function(a){
    console.log(a);   //firebug输出123456,使用+运算符
}(123456);

-function(a){
    console.log(a);   //firebug输出1234567,使用-运算符
}(1234567);

var fn=function(a){
    console.log(a);   //firebug输出12345678，使用=运算符
}(12345678)
```
**结论**：通过这个技术，可以模仿一个私有作用域，将匿名函数作为一个“容器”，容器内部可以访问外部变量，但外部不能访问内部变量。

```js
var a = 100;
 (function(){
     console.log(a);
     var a = 10;
 })();
//等价于：
var a = 100;
 (function(){
     var a;//变量名提升，此时的a未定义，若将该行去掉，则返回100
     console.log(a);//返回undefined
     a = 10;
 })();
```

此部分内容参考:[http://www.jb51.net/article/50967.htm](http://www.jb51.net/article/50967.htm)

---

# 网易有道的一道笔试题

题目：js点击ul中某个li标签,改变这个li标签的背景颜色,其他li标签背景为白色

方案1
```js
<body>
<ul id="list">
	<li onclick="change(this)">歌曲名称1</li>
	<li onclick="change(this)">歌曲名称2</li>
	<li onclick="change(this)">歌曲名称3</li>
</ul>
</body>
<script>
function change(obj){
var list =document.getElementById("list").getElementsByTagName("li");
for(var i=0;i<list.length;i++){		
	list[i].style.backgroundColor = 'white';
}
obj.style.backgroundColor = "red";
}
</script>
```

方案2
```js
<body>
<ul id="list2">
    <li>歌曲名称1</li>
    <li>歌曲名称2</li>
    <li>歌曲名称3</li>
    <li>歌曲名称4</li>
</ul>
</body>
<script>
var lis = document.getElementById("list2").getElementsByTagName("li");
var status = 0;//记录上一次的点击状态
var first_click = 0;//是否是第一次点击
for(var i=0;i<lis.length;i++){		
    (function(x){	//立即执行函数，作用域私有化，可以访问全局变量，但是外部不可以访问内部变量
	    lis[x].onclick = function(){	
		       if(first_click == 0){
				lis[x].style.backgroundColor = 'red';
				first_click = 1;
				status = x;
			   }
			   else{
				lis[status].style.backgroundColor = 'white';
				lis[x].style.backgroundColor = 'red';
				status = x;
				}	
			};
	})(i);
}	
</script>
```
